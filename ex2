HTML
-------------------------------------------------

<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Circle Movement</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="stylesheet" href="ex_02.css">
    </head>
    <body>
        <p>Move circle with arrow keys</p>
        <div class="out"><div class="circle"></div></div>
        <script src="ex_02.js"></script>
    </body>
</html>

css
---------------------------------------------------

@font-face {
  font-family: RobotoLight;
  font-style: normal;
  font-weight: 300;
  src: local('Roboto Light'), url(http://fonts.gstatic.com/s/roboto/v14/I3S1wsgSg9YCurV6PUkTOT8E0i7KZn-EPnyo3HZu7kw.woff) format('woff');
}

body {
    font-family: RobotoLight;
    font-size: 14px;
}

p {
    width: 300px;
    padding: 10px;
    border: 1px solid black;
    background-color: rgb(240,240,240);
}

div.out {
    position: relative;
}

div.circle {
    border: 1px solid black;
    border-radius: 50%;
    background-color: rgba(255,255,0,0.5);
    width: 30px;
    height: 30px;
    position: absolute;
    left: 0px;
    top: 0px;
}


javascript
-------------------------------------------------------------

// Keyboard events + animation
var move = false, speed = 3, diagonalSpeed,
    circle = document.getElementsByClassName('circle')[0],
    myleft = Number.parseInt(getComputedStyle(circle).left),
    mytop =  Number.parseInt(getComputedStyle(circle).top),
    direction = {
        left:  false,
        right: false,
        up:    false,
        down:  false
    };

diagonalSpeed = Math.sqrt( speed * speed / 2 );

var moveCircle = function () {
    var moveHorizontally, moveVertically, moveDiagonally;
    var actualSpeed;

    moveHorizontally = ( direction.left ) ? !direction.right : direction.right;
    moveVertically   = ( direction.up   ) ? !direction.down  : direction.down;
    moveDiagonally   = moveHorizontally && moveVertically;
    actualSpeed      = ( moveDiagonally ) ? diagonalSpeed : speed;

    if ( moveHorizontally ) {
        if ( direction.left ) {
            myleft = myleft - actualSpeed;
        }
        else {
            myleft = myleft + actualSpeed;
        }
        circle.style.left = myleft + 'px';
    }
    if ( moveVertically ) {
        if ( direction.up ) {
            mytop = mytop - actualSpeed;
        }
        else {
            mytop = mytop + actualSpeed;
        }
        circle.style.top = mytop + 'px';
    }

    if ( moveHorizontally || moveVertically ) {
        move = true;
        requestAnimationFrame(moveCircle);
    }
    else {
        move = false;
    }
};

document.addEventListener('keydown', function (evt) {
    switch (evt.code) {
        case 'ArrowLeft':
            direction.left = true;
            break;
        case 'ArrowRight':
            direction.right = true;
            break;
        case 'ArrowUp':
            direction.up = true;
            break;
        case 'ArrowDown':
            direction.down = true;
            break;
    }
    if ( !move ) {
        requestAnimationFrame(moveCircle);
    }
}, false);

document.addEventListener('keyup', function (evt) {
    switch (evt.code) {
        case 'ArrowLeft':
            direction.left = false;
            break;
        case 'ArrowRight':
            direction.right = false;
            break;
        case 'ArrowUp':
            direction.up = false;
            break;
        case 'ArrowDown':
            direction.down = false;
            break;
    }
    if ( !move ) {
        requestAnimationFrame(moveCircle);
    }
}, false);
